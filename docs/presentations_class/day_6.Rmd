---
title: "Data Import, Scripts, and the Critique"
author: J. Hathaway
params:
  day: 6
  ptitle: true
  pbackground: true
  dtype: "none"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

if (params$day %% 2 == 0) md_intro_format <- "even_intro_format.Rmd"
if (params$day %% 2 == 1) md_intro_format <- "odd_intro_format.Rmd"

```

# Becoming the Critic.

```{r nextone}
vday <- params$day - 1
vlink <- paste0("http://www.perceptualedge.com/example", vday, ".php")
titlelink <- paste0('{data-background-iframe="', vlink, '"}')
```

## `r titlelink`

[Visualization of the Day](`r vlink`)


```{r child=md_intro_format}

```



# Providing Critiques and the Routine

## A few critique examples

* [Mckay's](https://github.com/BYUI335/Davis_M/issues/5):  Notice how he responds that he has addressed the issues.
* [Aletha's Request](https://github.com/BYUI335/Pyeatt_A/issues/5):  Notice her request and the responses.
* [Hathaway's Example Response](https://github.com/BYUI335/Pyeatt_A/issues/7): Notice the formatting and references.



## Getting the Routine Down

- **I am expecting pushes to happen at least three times a week**
- [Leadership Task](https://byuistats.github.io/M335/tasklist.html)


# New functions

## Review the reading

Write this chunk of code out in an English sentence to your grandma.

```{r bob, evel=FALSE, echo=TRUE}
best_in_class <- mpg %>%
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)
```

## Data formats

If there is a data format that exists and is used, then there is a way to import that data into R. We will learn how to handle the basic tabular formats.  The packages `library(readr)`, `library(readxls)`, and `library(haven)` will provide most of the functionality we need.

## Understanding file types

* What is an [ASCII](https://www.webopedia.com/TERM/A/ASCII_file.html) file?
* Which of the following file formats are not ASCII?
    * `.csv`
    * `.html`
    * `.txt`
    * `.R`
    * `.xlsx`
    * `.Rmd`
    * `.doc`

## Data Import (task 6)

* What is the difference between `read.csv()` and `read_csv()`
* Read [this link (5.3.1)](https://csgillespie.github.io/efficientR/5-3-importing-data.html) and take some time to make a note in your task 6 `README.md` in your repository about the benefits.
* Push your updated `README.md` for me to read in class.


## `parse_` commands

Use this code - `money <- c("4,554,25", "$45", "8025.33cents", "288f45")`

* Apply `as.numeric(money)` and talk with your table about the output.
* Apply `parse_number(money)` and compare the results.

## Using `read_csv()` with parsers


> 1. Run this line of code below
> 2. Look at the errors (`problems(challenge)`), the `head()`, and `tail()` of your `challenge` object.  What formats should they be?
> 3. Now review [11.4.2 of our textbook](http://r4ds.had.co.nz/data-import.html#problems) and fix the read in.

```{r vle3, eval=FALSE, echo=TRUE}
challenge <- read_csv(readr_example("challenge.csv"))
```


## Scripts

Here are a few questions.  Discuss each one with your table and decide which file type to use - `.md`, `.r` or `.rmd`.  Then discuss the reasons for that decision.

1. I have a short memo to write for my boss that will not have any r code included.
2. I am working out some example R code to make sure I understand what it is doing ([see this for a twist](https://deanattali.com/2015/03/24/knitrs-best-hidden-gem-spin/)).
3. Brother Hathaway has some code snippets that he wants us to learn in class.
4. I have a report that I need to write which will include some writing and analysis.


## Scales

Each of the aesthetics has a paired scale function - x, y, size, color, fill, linetype, shape, alpha.  All of the scales start with `scale_` and then the respective aesthetic. All the aesthetic scales have an `_continuous`, `_discrete`, and `_manual`.  

> - `scale_x_` & `scale_y_` are the two scales I most often use
> - `scale_fill_` & `scale_color_` are the next most often used.
>     - manual()
>     - gradientn()

## Labelling Elements inside the graphic

The `library(ggrepel)` package is a must for our work. `library(directlabels)` can also be helpful. 
Here is the [book's graphic](http://r4ds.had.co.nz/communicate-plots_files/figure-html/unnamed-chunk-9-1.png). 

> - What are some concerns you have with this graphic?

## Code and graphic (scales)

Here is the [book's graphic](http://r4ds.had.co.nz/communicate-plots_files/figure-html/unnamed-chunk-9-1.png).  
Use the [code from 28.3](http://r4ds.had.co.nz/graphics-for-communication.html) and update their graphic to match mine.


```{r nnn2, fig.width=10, fig.height=4, echo=FALSE}
library(ggrepel)
library(viridis)

best_in_class <- mpg %>% 
  group_by(class) %>% 
  filter(row_number(desc(hwy)) == 1)

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class), size = 3) +
  geom_point(size = 1.5, data = best_in_class, color = "white") +
  geom_text_repel(aes(label = model, colour = class), 
                  data = best_in_class, show.legend = FALSE, 
                  nudge_x = -1, nudge_y = -2) +
  theme_bw() + 
  theme(panel.grid.minor = element_blank()) +
  scale_color_viridis(discrete = TRUE) + 
  labs(x = "Engine displacement", y = "Miles per gallon (highway)", 
       color = "Vehicle type")
```

## My Code Solution

```{r newname_code, eval=FALSE, echo=TRUE}
library(ggrepel)
library(viridis)

best_in_class <- mpg %>% 
  group_by(class) %>% 
  filter(row_number(desc(hwy)) == 1)

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class), size = 3) +
  geom_point(size = 1.5, data = best_in_class, color = "white") +
  geom_text_repel(aes(label = model, colour = class), 
                  data = best_in_class, show.legend = FALSE, 
                  nudge_x = -1, nudge_y = -2) +
  theme_bw() + theme(panel.grid.minor = element_blank()) +
  scale_color_viridis(discrete = TRUE) + 
  labs(x = "Engine displacement", y = "Miles per gallon (highway)", 
       color = "Vehicle type")
```


# Displaying multiple distributions

## Clarity vs. Complication

Data can get complicated very fast. How do we provide depth of variability understanding without overwhelming the visualization user?

> * [violin plots](http://eamoncaddigan.net/dataviz/r/psych/2015/09/26/violin-plots/)
> * [beeswarm plots](https://github.com/eclarke/ggbeeswarm)
> * [letter-value boxplots](https://github.com/hadley/lvplot)

Another package that makes flipping the axes easier in ggplot -- [rotating axes](https://github.com/lionel-/ggstance)

> * [link to last presentation](day_5.html#/displaying-distributions-of-multiple-groups-for-decision-making)

## Next Challenge

```{r newname_code2, echo=FALSE}
library(ggbeeswarm)
library(lvplot)

mpg %>%
ggplot(aes(x = class, y = hwy)) +
  geom_violin() +
  labs(x = "Class", y = "Miles per gallon (highway)") +
  theme_bw()

mpg %>%
ggplot(aes(x = class, y = hwy, color = factor(round(displ)))) +
  geom_quasirandom() +
  scale_color_viridis_d() +
  labs(x = "Class", y = "Miles per gallon (highway)", color = "Displacement") +
  theme_bw() + theme(legend.position = "bottom")

```